version: "3.3"

services:
  controller:
    image: tibmeister/unifi:6.0.45-14358-1
    volumes:
      - /nfs/swarm/unifi/data:/usr/lib/unifi/data
      - /nfs/swarm/unifi/logs:/usr/lib/unifi/logs
    ports:
      - 3478:3478/udp # Port used for STUN
      - 5514:5514/udp #Remote syslog
      - 8080:8080 #Used for device and app communications
      - 8443:8443 #port for controller GUI / API, as seen in web browser
      - 8080:8080 #port for UAP to inform controller
      - 8843:8843 #port for HTTPS portal redirect
      - 6789:6789 #port used for throughput measurement, including UniFi mobile speedtest
      - 27117:27117 #local-bound port for DB server
      - 10001:10001/udp #for AP Discovery
      - 1900:1900/udp # Port used for "Make application discoverable on L2 network" in the UniFi Network settings.
    logging:
      driver: json-file
    deploy:
      placement:
        constraints:
          - node.role != manager
    networks:
      - UniFi

networks:
  UniFi:
